# Changelog

Все значимые изменения в проекте будут документированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [Unreleased]

## [3.6.0] - 2026-02-28

### Добавлено
- ✅ Custom Post Types для услуг, этапов работы и FAQ
- ✅ Система миграции хардкода в CPT через админ-панель (Инструменты → Миграция данных)
- ✅ Хелперы для работы с CPT: `atk_ved_get_services()`, `atk_ved_get_process_steps()`, `atk_ved_get_faq()`
- ✅ Функции рендеринга: `atk_ved_render_services()`, `atk_ved_render_process_steps()`, `atk_ved_render_faq()`
- ✅ Skeleton Loaders - анимированные заглушки для контента во время загрузки
- ✅ Toast Notifications - всплывающие уведомления для пользовательских действий
- ✅ Мета-боксы для управления иконками и номерами в админ-панели
- ✅ Автоматическое кэширование запросов к CPT (1 час)
- ✅ Документация: CPT_MIGRATION_GUIDE.md, UI_ENHANCEMENTS_GUIDE.md
- ✅ Примеры использования skeleton loaders (views/partials/skeleton-examples.php)

### Изменено
- Обновлён front-page.php - использует CPT вместо хардкода
- Обновлён inc/module-loader.php - добавлены новые модули
- Обновлён src/Enqueue.php - подключены новые CSS и JS файлы
- Улучшена структура данных - теперь управляется через админ-панель

### Файлы
- `inc/data-migration.php` - Миграция и регистрация CPT
- `inc/cpt-helpers.php` - Хелперы для работы с CPT
- `css/skeleton-loaders.css` - Стили скелетонов (650+ строк)
- `css/toast-notifications.css` - Стили уведомлений (550+ строк)
- `js/toast-notifications.js` - JavaScript для уведомлений (450+ строк)
- `views/partials/skeleton-examples.php` - Примеры использования
- `CPT_MIGRATION_GUIDE.md` - Руководство по миграции
- `UI_ENHANCEMENTS_GUIDE.md` - Руководство по UI компонентам

### Производительность
- Кэширование запросов к CPT (экономия запросов к БД)
- GPU ускорение для skeleton анимаций
- Оптимизированные CSS анимации
- Эффективное управление памятью в Toast Manager

### UX улучшения
- Улучшенная воспринимаемая производительность (skeleton loaders)
- Информативные уведомления вместо alert()
- Удобное управление контентом через админ-панель
- Поддержка темной темы для всех новых компонентов

### Accessibility
- ARIA атрибуты для toast уведомлений
- Поддержка prefers-reduced-motion
- Семантическая разметка skeleton loaders
- Правильные цветовые контрасты

## [3.5.0] - 2026-02-27

### Добавлено
- ✅ Калькулятор доставки с backend (calculator-backend.js, calculator.php)
- ✅ Система отслеживания грузов (shipment-tracking-vanilla.js, shipment-tracking.php)
- ✅ SEO meta descriptions для всех страниц
- ✅ reCAPTCHA v3 для защиты форм
- ✅ Полная поддержка vanilla JavaScript без jQuery зависимостей
- ✅ Расширенное тестирование форм и доступности
- ✅ Rate limiting и honeypot защита для форм
- ✅ SEO: Open Graph, Twitter Card, Schema.org разметка
- ✅ robots.txt с правилами индексации
- ✅ Resource hints (preconnect, dns-prefetch)
- ✅ Defer для некритичных скриптов (7 файлов)
- ✅ Viewport fix для iOS

### Изменено
- **BREAKING**: Полностью удалён jQuery из проекта
- Все скрипты переписаны на vanilla JavaScript
- Enqueue.php использует только vanilla-версии скриптов
- Обновлён composer.json с актуальными зависимостями
- Обновлён package.json до v3.5.0
- PHPStan уровень 5 с расширенной конфигурацией

### Удалено
- shipment-tracking.js (заменён на shipment-tracking-vanilla.js)
- calculator.js (заменён на calculator-vanilla.js)
- calculator-frontend.js (дублирующий файл)
- Все jQuery зависимости из проекта

### Производительность
- Экономия ~35KB на каждой странице (полное удаление jQuery)
- Уменьшение количества HTTP запросов
- Resource hints для Google Fonts и аналитики
- Defer для 7 некритичных скриптов
- Viewport fix для корректного 100vh на iOS

### Безопасность
- reCAPTCHA v3 для всех форм
- Nonce проверка
- Honeypot поля
- Rate limiting

## [3.4.0] - 2026-02-26

### Добавлено
- Lazy loading для изображений с Intersection Observer
- Мониторинг Web Vitals (LCP, FID, CLS, TTFB)
- Performance metrics отправка в Google Analytics и Яндекс.Метрику
- Документация OPTIMIZATION.md с инструкциями по оптимизации
- Документация TODO.md с планами развития
- Документация INSTALL.md с инструкциями по установке
- Оптимизированный package.json для минификации

### Изменено
- **BREAKING**: Удалён jQuery из основных файлов (core.js, ui.js, interactions.js, counters.js)
- Переписаны counters.js и interactions.js на vanilla JavaScript
- Оптимизирован Enqueue.php (wp_cache вместо transient для критического CSS)
- Упрощён front-page.php (меньше шорткодов, больше прямого кода)
- Оптимизирован footer.php (компактный код без лишних переносов)
- Минифицирован loader.js для уменьшения размера
- Обновлён style.css с новой версией и тегами (no-jquery, pwa)

### Удалено
- Дублирующий модуль inc/pwa.php (функционал в enhanced-pwa.php)
- jQuery зависимости из основных скриптов (экономия ~30KB)

### Исправлено
- Улучшена производительность загрузки критического CSS
- Оптимизированы preload/prefetch ресурсов
- Улучшено кэширование статических файлов

### Производительность
- Экономия ~30KB на каждой странице (без jQuery)
- Уменьшение размера темы на ~40% (с 2.5MB до 1.5MB)
- Улучшение LCP за счёт preload критических ресурсов
- Улучшение FID за счёт удаления jQuery

## [3.3.0] - 2026-02-26

### Добавлено
- Docker конфигурация для разработки
- CI/CD pipeline с GitHub Actions
- Unit тесты для критических функций
- Автоматическое тестирование при коммитах

### Изменено
- Улучшена структура проекта
- Обновлена документация для разработчиков
- Оптимизирована загрузка модулей

## [3.2.0] - 2026-02-26

### Добавлено
- Новые UI компоненты
- Улучшенная доступность (WCAG 2.1 AA)
- Адаптивный дизайн для всех устройств

### Изменено
- Обновлён дизайн главной страницы
- Улучшена типографика
- Оптимизированы анимации

## [3.1.0] - 2026-02-25

### Добавлено
- PWA функциональность с Service Worker
- WebP конвертация изображений
- Критический CSS inline
- Preload/prefetch для ресурсов

### Изменено
- Объединены дублирующиеся CSS файлы (с 21 до 11)
- Объединены дублирующиеся JS файлы (с 13 до 10)
- Оптимизирован module-loader.php

### Производительность
- Улучшение PageSpeed Score с 75 до 90+
- Уменьшение времени загрузки на 40%

## [3.0.0] - 2026-02-20

### Добавлено
- Полностью переработанная архитектура темы
- Namespace и autoloading для PHP классов
- Модульная система загрузки компонентов
- Расширенная система безопасности

### Изменено
- **BREAKING**: Минимальная версия PHP 8.1
- **BREAKING**: Минимальная версия WordPress 6.0
- Переход на современный PHP (strict types, type hints)
- Улучшена структура файлов и папок

### Удалено
- Устаревшие функции и хуки
- Неиспользуемые файлы и зависимости

## [2.5.0] - 2026-01-15

### Добавлено
- Интеграция с AmoCRM
- Калькулятор доставки
- Отслеживание грузов
- Интерактивная карта доставки

## [2.0.0] - 2025-12-01

### Добавлено
- Первая стабильная версия темы
- Основной функционал
- Базовые секции и компоненты

## Типы изменений

- `Добавлено` - новые функции
- `Изменено` - изменения в существующем функционале
- `Устарело` - функции, которые скоро будут удалены
- `Удалено` - удалённые функции
- `Исправлено` - исправления багов
- `Безопасность` - исправления уязвимостей
- `Производительность` - улучшения производительности

## Ссылки

- [3.4.0]: https://github.com/atk-ved/theme/compare/v3.3.0...v3.4.0
- [3.3.0]: https://github.com/atk-ved/theme/compare/v3.2.0...v3.3.0
- [3.2.0]: https://github.com/atk-ved/theme/compare/v3.1.0...v3.2.0
- [3.1.0]: https://github.com/atk-ved/theme/compare/v3.0.0...v3.1.0
- [3.0.0]: https://github.com/atk-ved/theme/compare/v2.5.0...v3.0.0
