# Секция "Поиск товаров"

## Описание

Добавлена новая секция между "Наши услуги" и "Способы и сроки доставки грузов" с формой быстрой заявки на поиск товаров в Китае.

## Расположение

Секция находится в файле `index.php` между:
- `<!-- Services Section -->` 
- `<!-- Delivery Section -->`

## Структура секции

```html
<section class="search-section" id="search">
    <div class="container">
        <div class="search-content">
            <!-- Текст слева -->
            <div class="search-text">
                <h2>Заголовок</h2>
                <p>Описание</p>
            </div>
            
            <!-- Форма в центре -->
            <div class="search-form-block">
                <form class="quick-search-form">
                    <!-- Поля формы -->
                </form>
            </div>
            
            <!-- Изображение справа -->
            <div class="search-image">
                <img src="..." alt="...">
            </div>
        </div>
    </div>
</section>
```

## Функционал

### Форма заявки
- **Поле "Имя"** - обязательное текстовое поле
- **Поле "Телефон"** - обязательное поле для номера телефона
- **Чекбокс** - согласие с политикой конфиденциальности (обязательно)
- **Кнопка "Оставить заявку"** - отправка формы

### AJAX отправка
- Форма отправляется без перезагрузки страницы
- Валидация полей на стороне клиента
- Показ сообщений об успехе/ошибке
- Блокировка кнопки во время отправки

### Обработка на сервере
- AJAX обработчик: `atk_ved_quick_search_handler()`
- Файл: `inc/ajax-handlers.php`
- Действие: `atk_ved_quick_search`

### Сохранение данных
- Заявки сохраняются в админ-панели
- Тип записи: `contact_form`
- Меню: **Обращения** в админке
- Email уведомление администратору

## Настройка

### Изменить текст заголовка

Откройте `index.php` и найдите:
```html
<h2>НАЙДЕМ ТОВАР В КИТАЕ ПО ВАШЕМУ ЗАПРОСУ...</h2>
```

### Изменить текст описания

Откройте `index.php` и найдите:
```html
<p>Мы поможем найти, выкупить и доставить товары...</p>
```

### Изменить текст кнопки

Откройте `index.php` и найдите:
```html
<button type="submit" class="cta-button">ОСТАВИТЬ ЗАЯВКУ</button>
```

### Изменить email получателя

По умолчанию заявки отправляются на email администратора WordPress.

Чтобы изменить, откройте `inc/ajax-handlers.php` и найдите:
```php
$to = get_option('admin_email');
```

Замените на:
```php
$to = 'your-email@example.com';
```

### Добавить изображение

1. Загрузите изображение в папку `images/`
2. Назовите файл: `container-search.jpg`
3. Рекомендуемый размер: 600x800px
4. Формат: JPEG, качество 85%

Или измените путь в `index.php`:
```html
<img src="<?php echo get_template_directory_uri(); ?>/images/ваше-изображение.jpg" alt="...">
```

## Стили

### Основные стили
Файл: `style.css`
Секция: `/* Search Section */`

### Цвета
- Фон секции: `#fff` (белый)
- Цвет заголовка: `#e31e24` (красный)
- Цвет текста: `#666` (серый)
- Цвет границ: `#e0e0e0` (светло-серый)

### Изменить цвет заголовка

Откройте `style.css` и найдите:
```css
.search-text h2 {
    color: #e31e24; /* Измените здесь */
}
```

### Изменить размер шрифта

Откройте `style.css` и найдите:
```css
.search-text h2 {
    font-size: 28px; /* Измените здесь */
}
```

## Адаптивность

### Мобильные устройства (< 768px)
- Секция: `padding: 80px 0`
- Сетка: одна колонка (вертикальная)
- Заголовок: `font-size: 22px`
- Порядок: текст → форма → изображение

### Настройка адаптивности

Откройте `style.css` и найдите:
```css
@media (max-width: 768px) {
    .search-section {
        /* Ваши стили */
    }
}
```

## JavaScript

### Обработчик формы
Файл: `js/main.js`
Функция: обработка события `submit` для `#quickSearchForm`

### Валидация
- Проверка заполнения всех полей
- Проверка чекбокса согласия
- Показ alert при ошибках

### Изменить сообщения

Откройте `js/main.js` и найдите:
```javascript
alert('Спасибо! Ваша заявка принята...');
```

## Просмотр заявок в админке

1. Войдите в админ-панель WordPress
2. В меню слева найдите **Обращения**
3. Откройте заявку для просмотра деталей

### Поля заявки
- **Заголовок**: "Заявка на поиск товара - Имя - Дата"
- **Содержимое**: Имя и телефон
- **Мета-поля**: 
  - `_contact_name` - имя клиента
  - `_contact_phone` - телефон клиента
  - `_form_type` - тип формы (quick_search)

## Email уведомления

### Тема письма
```
Новая заявка на поиск товара - Название сайта
```

### Содержимое письма
```
Новая заявка на поиск товара в Китае

Имя: [имя клиента]
Телефон: [телефон клиента]
Дата: [дата и время]
IP: [IP адрес]
```

### Настройка email

Откройте `inc/ajax-handlers.php` и найдите функцию `atk_ved_quick_search_handler()`.

Измените:
- `$subject` - тема письма
- `$body` - содержимое письма
- `$headers` - заголовки письма

## Безопасность

### Защита от спама
- AJAX nonce проверка
- Санитизация данных (`sanitize_text_field`)
- Валидация на клиенте и сервере

### Дополнительная защита

Добавьте Google reCAPTCHA:
1. Зарегистрируйтесь на https://www.google.com/recaptcha
2. Получите ключи API
3. Добавьте виджет reCAPTCHA в форму
4. Проверяйте токен на сервере

## Тестирование

### Проверка формы
1. Откройте сайт
2. Прокрутите до секции "Поиск товаров"
3. Заполните форму
4. Нажмите "Оставить заявку"
5. Проверьте сообщение об успехе
6. Проверьте email
7. Проверьте админку (Обращения)

### Проверка валидации
1. Попробуйте отправить пустую форму
2. Попробуйте без чекбокса
3. Проверьте сообщения об ошибках

### Проверка адаптивности
1. Откройте сайт на мобильном
2. Проверьте отображение формы
3. Проверьте работу формы

## Устранение проблем

### Форма не отправляется

**Проблема**: При нажатии кнопки ничего не происходит

**Решение**:
1. Откройте консоль браузера (F12)
2. Проверьте ошибки JavaScript
3. Убедитесь, что jQuery загружен
4. Проверьте, что `atkVedData` определен

### Email не приходит

**Проблема**: Заявка сохраняется, но email не приходит

**Решение**:
1. Проверьте настройки SMTP на хостинге
2. Установите плагин WP Mail SMTP
3. Проверьте папку "Спам"
4. Проверьте логи сервера

### Заявки не сохраняются

**Проблема**: Email приходит, но заявки нет в админке

**Решение**:
1. Проверьте, что тип записи `contact_form` зарегистрирован
2. Откройте `inc/ajax-handlers.php`
3. Проверьте функцию `atk_ved_register_contact_form_post_type()`
4. Очистите кэш WordPress

### Ошибка 403 или 500

**Проблема**: При отправке формы ошибка сервера

**Решение**:
1. Проверьте логи PHP
2. Увеличьте лимит памяти
3. Проверьте права доступа к файлам
4. Отключите плагины безопасности временно

## Дополнительные возможности

### Добавить поле "Email"

1. Откройте `index.php`
2. Добавьте после поля телефона:
```html
<input type="email" name="email" placeholder="Ваш email" required>
```

3. Откройте `js/main.js`
4. Добавьте в валидацию:
```javascript
var email = $form.find('input[name="email"]').val().trim();
```

5. Откройте `inc/ajax-handlers.php`
6. Добавьте обработку:
```php
$email = sanitize_email($_POST['email']);
```

### Добавить поле "Сообщение"

1. Откройте `index.php`
2. Добавьте textarea:
```html
<textarea name="message" placeholder="Опишите, что вы ищете" rows="4"></textarea>
```

3. Обновите обработчики аналогично

### Интеграция с CRM

Для отправки заявок в CRM (AmoCRM, Bitrix24 и т.д.):

1. Откройте `inc/ajax-handlers.php`
2. Найдите функцию `atk_ved_quick_search_handler()`
3. Добавьте после отправки email:
```php
// Отправка в CRM
$crm_data = array(
    'name' => $name,
    'phone' => $phone,
);
// Ваш код интеграции с CRM
```

## Поддержка

При возникновении проблем:
1. Проверьте консоль браузера (F12)
2. Проверьте логи PHP
3. Проверьте версию WordPress (5.0+)
4. Проверьте версию PHP (7.4+)

---

**Версия:** 1.4  
**Дата:** 25 февраля 2026  
**Файлы:**
- `index.php` - HTML разметка
- `style.css` - стили секции
- `js/main.js` - JavaScript обработчик
- `inc/ajax-handlers.php` - серверная обработка
