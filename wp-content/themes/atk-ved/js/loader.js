/**
 * Оптимизированный загрузчик (Minified)
 * @package ATK_VED
 */
(function(){'use strict';const s='IntersectionObserver'in window;function loadScript(src,cb){const sc=document.createElement('script');sc.src=src;sc.async=true;if(cb)sc.onload=cb;document.body.appendChild(sc)}function initLazyScripts(){const sections={'.calculator-section':'calculator','.tracking-section':'tracking','.gallery-section':'gallery','.statistics-section':'statistics'};if(s){const obs=new IntersectionObserver(entries=>{entries.forEach(e=>{if(e.isIntersecting){const sec=e.target;const scr=sec.dataset.script;if(scr&&!sec.dataset.loaded){sec.dataset.loaded='true';obs.unobserve(sec)}}})},{rootMargin:'200px'});Object.keys(sections).forEach(sel=>{const el=document.querySelector(sel);if(el){el.dataset.script=sections[sel];obs.observe(el)}})}}function optimizeImages(){const imgs=document.querySelectorAll('img[loading="lazy"]');if(!s){imgs.forEach(img=>img.loading='eager');return}const imgObs=new IntersectionObserver(entries=>{entries.forEach(e=>{if(e.isIntersecting){const img=e.target;img.addEventListener('load',()=>img.classList.add('loaded'));imgObs.unobserve(img)}})},{rootMargin:'50px'});imgs.forEach(img=>imgObs.observe(img))}function preloadCriticalImages(){[document.querySelector('.hero-image img'),document.querySelector('.logo-link img')].forEach(img=>{if(img&&img.src){const link=document.createElement('link');link.rel='preload';link.as='image';link.href=img.src;document.head.appendChild(link)}})}function loadDeferredCSS(){document.querySelectorAll('link[rel="preload"][as="style"]').forEach(link=>link.onload=function(){this.rel='stylesheet'})}function optimizePerformance(){if('ontouchstart'in window)document.body.classList.add('touch-device');let rt;window.addEventListener('resize',()=>{document.body.classList.add('resize-active');clearTimeout(rt);rt=setTimeout(()=>document.body.classList.remove('resize-active'),400)});let st;window.addEventListener('scroll',()=>{clearTimeout(st);if(!document.body.classList.contains('disable-hover'))document.body.classList.add('disable-hover');st=setTimeout(()=>document.body.classList.remove('disable-hover'),200)},{passive:true})}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>{initLazyScripts();optimizeImages();preloadCriticalImages();loadDeferredCSS();optimizePerformance()})}else{initLazyScripts();optimizeImages();preloadCriticalImages();loadDeferredCSS();optimizePerformance()}})();
